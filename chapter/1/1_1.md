# 演習問題 1.1

## 問題
二値分類問題において、正答率（accuracy）は高いが、適合率（precision）と再現率（recall）はともに低くなるような具体例を構成せよ

## 解答

## 前提知識
二値分類問題において、予測結果 (Positive(+) / Negative(-) ) と、真の値（True(T) / False(F) ）を基準として、それらに適合するサンプルの数を次の表で整理する。

| 予測 \ 真の値         | True                       | False                       |
| --------------- | ------------------------------------- | ------------------------------------- |
| Positive | **True Positive (TP)**       | **False Positive (FP：誤検知)** |
| Negative | **False Negative (FN:見逃し)** | **True Negative (TN)**       |

表の列名のTrue / False は真の値そのものを表すが、各セルの True / False　は真の値がどちらなのかではなく、予測が合っているかどうか？を表していることに注意する。 

- True Positive (TP): 予測が + で、その判定が合っている（真の値は T）ようなサンプルの数
- False Positive (FP): 予測が + で、その判定が間違っている（真の値は F）ようなサンプルの数
- False Negative (FN): 予測が - で、その判定は間違っている（真の値は T）ようなサンプルの数
- True Negative (TN): 予測が - で、その判定は合っている（真の値は F）ようなサンプルの数

そのうえで、正答率 (Accuracy)、適合率 (Precision)、再現率 (Recall) はそれぞれ次のように定義される：

$$ Accuracy = \frac{TP + TN}{TP + FP + TN + FN} $$
$$ Precision = \frac{TP}{TP + FP} $$
$$ Recall = \frac{TP}{TP + FN} $$

正答率 (Accuracy) は、すべてのサンプルの中で、予想が正解した割合を示す。

適合率 (Precision) は、+と予測したサンプルの中で、正解であるもの（実際にTであるもの）の割合を示す。つまり誤検知の少なさを表す。

再現率 (Recall) は、真の値がTであるサンプルの中で、実際に+と言い当てられたサンプルの割合を示す。つまり見逃し率の少なさを表す。

## 解答
式の形から、TN が大きく、TPが小さいと良さそうである。また、FPやFNもTNほどではないが、TPより大きいほうが良いだろう。
例えば、以下のような場合

| 予測 \ 真の値         | True                       | False                       |
| --------------- | ------------------------------------- | ------------------------------------- |
| Positive | **True Positive (TP): 10**       | **False Positive (FP): 90** |
| Negative | **False Negative (FN): 90** | **True Negative (TN): 810**       |

このとき、3つの指標の値は：

$$ Accuracy = \frac{10 + 810}{10 + 90 + 810 + 90} = 0.82 $$
$$ Precision = \frac{10}{10 + 90} = 0.1 $$
$$ Recall = \frac{10}{10 + 90} = 0.1 $$

となり、条件を満たす。

真の値がFであるようなサンプルがTのサンプルより明らかに多い場合、基本的に「Negative」とだけ予測すればだいたい当たる（Accuracyは高くなる）。ただ、真の値がTのサンプルの判定が正確でない場合、Positive判定を下したサンプルの中に含まれるTのサンプルの割合が減りPrecisionが下がる。真の値がTのサンプルだけ見た場合にも「Negative」と判定（FN）する割合も増えるので、Recallも下がってしまう。

特定の希少なウイルスに感染しているかどうか？→データがあまりないので、とりあえずNegative判定。本当に感染している場合の予測精度も期待できない場合、などが該当する。

## 参考文献
https://www.chowagiken.co.jp/blog/Precision_Recall

